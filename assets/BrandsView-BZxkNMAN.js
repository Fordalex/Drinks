import{d as C,u as T,r as k,e as _,_ as F,l as p,o as d,c as V,w as a,n as N,a as e,i as v,j as b,t as $,b as R,p as j,s as B,x as w,v as q,g,F as h,k as y,y as E,z as M,f as O,h as P,V as S}from"./index-DnvRLiit.js";import{R as z,S as D,V as I,a as U}from"./VForm-TVvqgWn1.js";import{S as x}from"./SpiritLink-Bnplj_k1.js";import{V as f}from"./VCol-mdlYBquf.js";import{V as L}from"./VContainer-BniP9kR8.js";import{V as G}from"./VSkeletonLoader-Bh_PGYJS.js";const H=C({name:"BrandForm",props:{brand:{type:Object,required:!1,default:()=>({name:"",image:""})}},components:{RecordForm:z,SelectFromRequest:D},setup(o){T();const t=k([]),r=_(()=>!!o.brand.id),i=_(()=>r.value?`https://api.fordsdevelopment.co.uk/drinks/brands/${o.brand.id}`:"https://api.fordsdevelopment.co.uk/drinks/brands"),c=_(()=>r.value?"PUT":"POST");return{isEditMode:r,endpoint:i,method:c,handleSave:async s=>{console.log(`${r.value?"Updated":"Created"} record:`,s),window.location.reload()},value:t}}});function J(o,t,r,i,c,u){const s=p("SelectFromRequest"),l=p("RecordForm");return d(),V(l,{record:o.brand,endpoint:o.endpoint,method:o.method,onSave:o.handleSave},{trigger:a(({openDialog:n})=>[N(o.$slots,"trigger",{openDialog:n},()=>[e(v,{color:"primary"},{default:a(()=>[b($(o.isEditMode?"Edit Spirit":"Add Brand"),1)]),_:1})])]),title:a(()=>[R("span",null,$(o.isEditMode?"Edit Brand":"Add New Brand"),1)]),form:a(({record:n})=>[e(I,null,{default:a(()=>[e(U,{modelValue:n.name,"onUpdate:modelValue":m=>n.name=m,label:"Name",required:""},null,8,["modelValue","onUpdate:modelValue"]),e(U,{modelValue:n.logo,"onUpdate:modelValue":m=>n.logo=m,label:"Image"},null,8,["modelValue","onUpdate:modelValue"]),e(s,{path:"companies",key:"name",name:"company_id",modelValue:n.company_id,"onUpdate:modelValue":m=>n.company_id=m},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:3},8,["record","endpoint","method","onSave"])}const A=F(H,[["render",J]]),K=C({name:"Brand",props:{brand:{type:Object,required:!0}},components:{BrandForm:A,SpiritLink:x},setup(o){return{brandLink:_(()=>`/Drinks/#/brands/${o.brand.id}`)}}});function Q(o,t,r,i,c,u){const s=p("BrandForm"),l=p("SpiritLink");return d(),V(M,null,{loader:a(({isActive:n})=>[e(j,{active:n,color:"deep-purple",height:"4",indeterminate:""},null,8,["active"])]),default:a(()=>[e(f,{cols:"12"},{default:a(()=>[e(s,{brand:o.brand},{trigger:a(({openDialog:n})=>[e(v,{density:"comfortable",icon:"mdi-dots-vertical",variant:"tonal",onClick:n},null,8,["onClick"])]),_:1},8,["brand"])]),_:1}),e(B,null,{default:a(()=>[e(w,null,{default:a(()=>{var n;return[b("Company: "+$((n=o.brand.company)==null?void 0:n.name),1)]}),_:1})]),_:1}),e(B,null,{default:a(()=>[e(q,null,{default:a(()=>[b($(o.brand.name),1)]),_:1})]),_:1}),e(B,null,{default:a(()=>[e(w,null,{default:a(()=>t[0]||(t[0]=[b("Spirits")])),_:1}),(d(!0),g(h,null,y(o.brand.spirits,n=>(d(),V(l,{key:n.id,spirit:n},null,8,["spirit"]))),128))]),_:1}),e(E,null,{default:a(()=>[e(v,{href:o.brandLink,color:"deep-purple-lighten-2",text:"More",block:"",border:""},null,8,["href"])]),_:1})]),_:1})}const W=F(K,[["render",Q]]),X=C({name:"BrandsView",components:{BrandForm:A,Brand:W},setup(){const o=k([]),t=k(!0),r=_(()=>"https://api.fordsdevelopment.co.uk/drinks/brands"),i=k(null),c=async()=>{const u=T(),l=await fetch("https://api.fordsdevelopment.co.uk/drinks/brands",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${u.accessToken}`}});if(l.ok)t.value=!1,o.value=await l.json();else{t.value=!1;const n=await l.json();i.value=n.error,n.error==="Access token has expired or is invalid."&&(console.log("Access token has expired or is invalid."),u.$reset(),u.clearState())}};return O(()=>{c()}),{brands:o,loading:t,endpoint:r,errorMessage:i}}});function Y(o,t,r,i,c,u){const s=p("BrandForm"),l=p("Brand");return d(),g(h,null,[e(L,null,{default:a(()=>[e(S,null,{default:a(()=>[e(f,{cols:"6"},{default:a(()=>t[0]||(t[0]=[R("h1",null,"Brands",-1)])),_:1}),e(f,{cols:"6",class:"text-right"},{default:a(()=>[e(s,null,{trigger:a(({openDialog:n})=>[e(v,{density:"comfortable",variant:"tonal",text:"New Brand",onClick:n},null,8,["onClick"])]),_:1})]),_:1})]),_:1}),e(S,null,{default:a(()=>[(d(!0),g(h,null,y(o.brands,n=>(d(),V(f,{cols:"12",sm:"6",md:"4",lg:"3",key:n.id},{default:a(()=>[e(l,{brand:n},null,8,["brand"])]),_:2},1024))),128))]),_:1})]),_:1}),o.loading?(d(),V(L,{key:0},{default:a(()=>[e(S,null,{default:a(()=>[(d(),g(h,null,y(16,n=>e(f,{cols:"12",sm:"6",md:"4",lg:"3"},{default:a(()=>[e(G,{class:"border",type:"image, article"})]),_:1})),64))]),_:1})]),_:1})):P("",!0)],64)}const re=F(X,[["render",Y]]);export{re as default};
