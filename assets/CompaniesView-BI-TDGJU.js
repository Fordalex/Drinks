import{d as F,u as R,r as h,e as f,_ as S,l as y,o as d,c as i,w as o,n as q,a,i as v,j as w,t as _,b as M,p as N,q as A,s as U,v as E,x as L,y as I,f as O,g as $,h as g,F as b,V as C,k as T}from"./index-eBtsC5WD.js";import{M as P}from"./Map-8Uyoy1Xl.js";import{R as D,S as z,V as H,a as B}from"./VForm-BUdm5Vj8.js";import{V as u}from"./VCol-nDutiMUy.js";import{V as k}from"./VContainer-rx-twh71.js";import{V as G,a as J}from"./VSkeletonLoader-pPNv_yPg.js";const K=F({name:"CompanyForm",props:{company:{type:Object,required:!1,default:()=>({name:"",image:""})}},components:{RecordForm:D,SelectFromRequest:z},setup(e){R();const l=h([]),t=f(()=>!!e.company.id),s=f(()=>t.value?`https://api.fordsdevelopment.co.uk/drinks/companies/${e.company.id}`:"https://api.fordsdevelopment.co.uk/drinks/companies"),p=f(()=>t.value?"PUT":"POST");return{isEditMode:t,endpoint:s,method:p,handleSave:async r=>{console.log(`${t.value?"Updated":"Created"} record:`,r),window.location.reload()},value:l}}});function Q(e,l,t,s,p,V){const r=y("SelectFromRequest"),m=y("RecordForm");return d(),i(m,{record:e.company,endpoint:e.endpoint,method:e.method,onSave:e.handleSave},{trigger:o(({openDialog:n})=>[q(e.$slots,"trigger",{openDialog:n},()=>[a(v,{color:"primary"},{default:o(()=>[w(_(e.isEditMode?"Edit Spirit":"Add Company"),1)]),_:1})])]),title:o(()=>[M("span",null,_(e.isEditMode?"Edit Company":"Add New Company"),1)]),form:o(({record:n})=>[a(H,null,{default:o(()=>[a(B,{modelValue:n.name,"onUpdate:modelValue":c=>n.name=c,label:"Name",required:""},null,8,["modelValue","onUpdate:modelValue"]),a(B,{modelValue:n.logo,"onUpdate:modelValue":c=>n.logo=c,label:"Image"},null,8,["modelValue","onUpdate:modelValue"]),a(r,{path:"brands",key:"name",name:"brand_ids",multiple:!0,modelValue:n.brand_ids,"onUpdate:modelValue":c=>n.brand_ids=c},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:3},8,["record","endpoint","method","onSave"])}const j=S(K,[["render",Q]]),W=F({name:"Company",props:{company:{type:Object,required:!0}},components:{CompanyForm:j},setup(e){const l=f(()=>`/Drinks/#/companies/${e.company.id}`),t=f(()=>e.company.brands.map(s=>s.name).join(", "));return{companyLink:l,brands:t}}});function X(e,l,t,s,p,V){const r=y("CompanyForm");return d(),i(I,null,{loader:o(({isActive:m})=>[a(N,{active:m,color:"deep-purple",height:"4",indeterminate:""},null,8,["active"])]),default:o(()=>[a(u,{cols:"12"},{default:o(()=>[a(r,{company:e.company},{trigger:o(({openDialog:m})=>[a(v,{density:"comfortable",icon:"mdi-dots-vertical",variant:"tonal",onClick:m},null,8,["onClick"])]),_:1},8,["company"])]),_:1}),a(A,{height:"250",src:e.company.logo,cover:""},null,8,["src"]),a(U,null,{default:o(()=>[a(E,null,{default:o(()=>[w(_(e.company.name),1)]),_:1})]),_:1}),a(U,null,{default:o(()=>[M("p",null,"Brands: "+_(e.brands),1)]),_:1}),a(L,null,{default:o(()=>[a(v,{href:e.companyLink,color:"deep-purple-lighten-2",text:"More",block:"",border:""},null,8,["href"])]),_:1})]),_:1})}const Y=S(W,[["render",X]]),Z=F({name:"HomeView",components:{Map:P,Company:Y,CompanyForm:j},setup(){const e=R(),l=h([]),t=h(null),s=h(!0),p=async()=>{const r=await fetch("https://api.fordsdevelopment.co.uk/drinks/companies",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.accessToken}`}});if(r.ok)l.value=await r.json(),s.value=!1;else{const m=await r.json();t.value=m.error,s.value=!1}};return O(()=>{p()}),{fetchCompanies:p,companies:l,errorMessage:t,loading:s}}});function x(e,l,t,s,p,V){const r=y("CompanyForm"),m=y("Company");return d(),$(b,null,[a(k,null,{default:o(()=>[a(C,null,{default:o(()=>[a(u,{cols:"6"},{default:o(()=>l[0]||(l[0]=[M("h1",null,"Companies",-1)])),_:1}),a(u,{cols:"6",class:"text-right"},{default:o(()=>[a(r,{company:e.company},{trigger:o(({openDialog:n})=>[a(v,{density:"comfortable",variant:"tonal",text:"New Company",onClick:n},null,8,["onClick"])]),_:1},8,["company"])]),_:1})]),_:1})]),_:1}),e.loading?g("",!0):(d(),i(k,{key:0},{default:o(()=>[a(C,null,{default:o(()=>[a(u,{cols:"12"},{default:o(()=>[e.errorMessage?(d(),i(G,{key:0,type:"error",dismissible:"",border:"left",elevation:"2"},{default:o(()=>[w(_(e.errorMessage),1)]),_:1})):g("",!0)]),_:1})]),_:1})]),_:1})),e.loading?g("",!0):(d(),i(k,{key:1},{default:o(()=>[a(C,null,{default:o(()=>[(d(!0),$(b,null,T(e.companies,n=>(d(),i(u,{cols:"12",sm:"6",md:"4",lg:"3",key:n.id},{default:o(()=>[a(m,{company:n},null,8,["company"])]),_:2},1024))),128))]),_:1})]),_:1})),e.loading?(d(),i(k,{key:2},{default:o(()=>[a(C,null,{default:o(()=>[(d(),$(b,null,T(16,n=>a(u,{cols:"12",sm:"6",md:"4",lg:"3"},{default:o(()=>[a(J,{class:"border",type:"image, article"})]),_:1})),64))]),_:1})]),_:1})):g("",!0)],64)}const re=S(Z,[["render",x]]);export{re as default};
