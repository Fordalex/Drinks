import{d as J,u as ie,r as S,e as v,z as ve,A as ye,I as Ve,B as he,C as ge,D as _e,f as ke,E as F,G as Se,H as we,J as Ce,a as t,K as q,F as E,L as te,M as be,N as xe,O as Fe,P as O,Q as $e,R as Ue,S as Re,_ as K,l as $,o as k,c as b,w as o,n as Pe,i as G,j as x,t as f,b as h,g as le,T as z,q as Te,s as Ie,v as Be,U as Ne,V as Ee,k as ze,h as L,x as Me,y as Ae}from"./index-CT-GqKWP.js";import{R as De,S as He,m as qe,b as Oe,u as Le,c as ae,f as je,d as Ge,e as Je,V as Ke,a as N,g as j}from"./VForm-DxEXEUW1.js";import{V as Qe}from"./VCol-6K7bv0ry.js";import{V as We}from"./VRating-iODfQQOI.js";const Xe=J({name:"SpiritForm",props:{spirit:{type:Object,required:!1,default:()=>({name:"",description:"",image:"",rating:0,spirit_type_id:null,spirit_style_id:null})}},components:{RecordForm:De,SelectFromRequest:He},setup(e){ie();const m=["Vanilla","Caramel","Spicy","Fruity","Floral","Herbal","Smoky","Woody"],u=S([]),c=v(()=>!!e.spirit.id),r=v(()=>c.value?`https://api.fordsdevelopment.co.uk/drinks/spirits/${e.spirit.id}`:"https://api.fordsdevelopment.co.uk/drinks/spirits"),s=v(()=>c.value?"PUT":"POST");return{isEditMode:c,endpoint:r,method:s,handleSave:async y=>{console.log(`${c.value?"Updated":"Created"} record:`,y),window.location.reload()},items:m,value:u}}}),Ye=ve({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...qe(),...Oe()},"VTextarea"),Ze=ye()({name:"VTextarea",directives:{Intersect:Ve},inheritAttrs:!1,props:Ye(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,m){let{attrs:u,emit:c,slots:r}=m;const s=he(e,"modelValue"),{isFocused:n,focus:y,blur:a}=Le(e),i=v(()=>typeof e.counterValue=="function"?e.counterValue(s.value):(s.value||"").toString().length),U=v(()=>{if(u.maxlength)return u.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function ne(l,p){var d,V;!e.autofocus||!l||(V=(d=p[0].target)==null?void 0:d.focus)==null||V.call(d)}const Q=S(),R=S(),W=ge(""),P=S(),oe=v(()=>e.persistentPlaceholder||n.value||e.active);function M(){var l;P.value!==document.activeElement&&((l=P.value)==null||l.focus()),n.value||y()}function se(l){M(),c("click:control",l)}function re(l){c("mousedown:control",l)}function de(l){l.stopPropagation(),M(),O(()=>{s.value="",$e(e["onClick:clear"],l)})}function ue(l){var d;const p=l.target;if(s.value=p.value,(d=e.modelModifiers)!=null&&d.trim){const V=[p.selectionStart,p.selectionEnd];O(()=>{p.selectionStart=V[0],p.selectionEnd=V[1]})}}const w=S(),T=S(+e.rows),A=v(()=>["plain","underlined"].includes(e.variant));_e(()=>{e.autoGrow||(T.value=+e.rows)});function C(){e.autoGrow&&O(()=>{if(!w.value||!R.value)return;const l=getComputedStyle(w.value),p=getComputedStyle(R.value.$el),d=parseFloat(l.getPropertyValue("--v-field-padding-top"))+parseFloat(l.getPropertyValue("--v-input-padding-top"))+parseFloat(l.getPropertyValue("--v-field-padding-bottom")),V=w.value.scrollHeight,I=parseFloat(l.lineHeight),D=Math.max(parseFloat(e.rows)*I+d,parseFloat(p.getPropertyValue("--v-input-control-height"))),H=parseFloat(e.maxRows)*I+d||1/0,_=Re(V??0,D,H);T.value=Math.floor((_-d)/I),W.value=Ue(_)})}ke(C),F(s,C),F(()=>e.rows,C),F(()=>e.maxRows,C),F(()=>e.density,C);let g;return F(w,l=>{l?(g=new ResizeObserver(C),g.observe(w.value)):g==null||g.disconnect()}),Se(()=>{g==null||g.disconnect()}),we(()=>{const l=!!(r.counter||e.counter||e.counterValue),p=!!(l||r.details),[d,V]=Ce(u),{modelValue:I,...D}=ae.filterProps(e),H=je(e);return t(ae,q({ref:Q,modelValue:s.value,"onUpdate:modelValue":_=>s.value=_,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":A.value},e.class],style:e.style},d,D,{centerAffix:T.value===1&&!A.value,focused:n.value}),{...r,default:_=>{let{id:B,isDisabled:X,isDirty:Y,isReadonly:ce,isValid:me}=_;return t(Ge,q({ref:R,style:{"--v-textarea-control-height":W.value},onClick:se,onMousedown:re,"onClick:clear":de,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},H,{id:B.value,active:oe.value||Y.value,centerAffix:T.value===1&&!A.value,dirty:Y.value||e.dirty,disabled:X.value,focused:n.value,error:me.value===!1}),{...r,default:pe=>{let{props:{class:Z,...ee}}=pe;return t(E,null,[e.prefix&&t("span",{class:"v-text-field__prefix"},[e.prefix]),te(t("textarea",q({ref:P,class:Z,value:s.value,onInput:ue,autofocus:e.autofocus,readonly:ce.value,disabled:X.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:M,onBlur:a},ee,V),null),[[be("intersect"),{handler:ne},null,{once:!0}]]),e.autoGrow&&te(t("textarea",{class:[Z,"v-textarea__sizer"],id:`${ee.id}-sizer`,"onUpdate:modelValue":fe=>s.value=fe,ref:w,readonly:!0,"aria-hidden":"true"},null),[[xe,s.value]]),e.suffix&&t("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:p?_=>{var B;return t(E,null,[(B=r.details)==null?void 0:B.call(r,_),l&&t(E,null,[t("span",null,null),t(Je,{active:e.persistentCounter||n.value,value:i.value,max:U.value,disabled:e.disabled},r.counter)])])}:void 0})}),Fe({},Q,R,P)}});function et(e,m,u,c,r,s){const n=$("SelectFromRequest"),y=$("RecordForm");return k(),b(y,{record:e.spirit,endpoint:e.endpoint,method:e.method,onSave:e.handleSave},{trigger:o(({openDialog:a})=>[Pe(e.$slots,"trigger",{openDialog:a},()=>[t(G,{color:"primary"},{default:o(()=>[x(f(e.isEditMode?"Edit Spirit":"Add Spirit"),1)]),_:1})])]),title:o(()=>[h("span",null,f(e.isEditMode?"Edit Spirit":"Add New Spirit"),1)]),form:o(({record:a})=>[t(Ke,null,{default:o(()=>[t(N,{modelValue:a.name,"onUpdate:modelValue":i=>a.name=i,label:"Name",required:""},null,8,["modelValue","onUpdate:modelValue"]),t(Ze,{modelValue:a.description,"onUpdate:modelValue":i=>a.description=i,label:"Description",rows:"4",required:""},null,8,["modelValue","onUpdate:modelValue"]),t(N,{modelValue:a.image,"onUpdate:modelValue":i=>a.image=i,label:"Image"},null,8,["modelValue","onUpdate:modelValue"]),t(N,{modelValue:a.rating,"onUpdate:modelValue":i=>a.rating=i,label:"Rating"},null,8,["modelValue","onUpdate:modelValue"]),t(N,{modelValue:a.ppm,"onUpdate:modelValue":i=>a.ppm=i,label:"Ppm"},null,8,["modelValue","onUpdate:modelValue"]),t(n,{path:"spirit_types",key:"name",name:"spirit_type_id",modelValue:a.spirit_type_id,"onUpdate:modelValue":i=>a.spirit_type_id=i},null,8,["modelValue","onUpdate:modelValue"]),t(n,{path:"spirit_styles",key:"name",name:"spirit_style_id",modelValue:a.spirit_style_id,"onUpdate:modelValue":i=>a.spirit_style_id=i},null,8,["modelValue","onUpdate:modelValue"]),t(n,{path:"distilleries",key:"name",name:"distillery_id",multiple:!0,modelValue:a.distillery_ids,"onUpdate:modelValue":i=>a.distillery_ids=i},null,8,["modelValue","onUpdate:modelValue"]),t(n,{path:"brands",key:"name",name:"brand_id",modelValue:a.brand_id,"onUpdate:modelValue":i=>a.brand_id=i},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:3},8,["record","endpoint","method","onSave"])}const tt=K(Xe,[["render",et]]),at=J({name:"DistilleryLink",props:{distillery:{type:Object,required:!0}},setup(e){const m=S({...e.distillery}),u=v(()=>`https://api.fordsdevelopment.co.uk/drinks/distilleries/${e.distillery.id}`);return{distillery:m,endpoint:u}}}),it={class:"text-subtitle-1 spirit-factory"};function lt(e,m,u,c,r,s){const n=$("router-link");return k(),le("p",it,[t(z,{color:"black",icon:"mdi-factory",size:"large",class:"mr-2"}),t(n,{to:{name:"distillery",params:{id:e.distillery.id}}},{default:o(()=>[x(f(e.distillery.name),1)]),_:1},8,["to"])])}const nt=K(at,[["render",lt]]),ot=J({name:"Spirit",props:{spirit:{type:Object,required:!0}},components:{SpiritForm:tt,DistilleryLink:nt},setup(e){const m=S({...e.spirit}),u=ie(),c=v(()=>`https://api.fordsdevelopment.co.uk/drinks/spirits/${e.spirit.id}`),r=v(()=>`/Drinks/#/spirits/${e.spirit.id}`);return{editedSpirit:m,saveChanges:async({data:n,endpoint:y})=>{try{const a=await fetch(y,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u.accessToken}`},body:JSON.stringify(n)});if(!a.ok)throw new Error(`Error: ${a.status} - ${a.statusText}`);const i=await a.json();m.value=i,window.location.reload()}catch(a){console.error("Error saving spirit:",a)}},endpoint:c,spiritLink:r}}}),st={class:"image-container"},rt={class:"py-1"},dt={class:"py-1"},ut={class:"py-1"},ct={class:"py-1"};function mt(e,m,u,c,r,s){const n=$("SpiritForm"),y=$("DistilleryLink");return k(),b(Ae,null,{default:o(()=>[t(Qe,{cols:"12"},{default:o(()=>[t(n,{spirit:e.spirit},{trigger:o(({openDialog:a})=>[t(G,{density:"comfortable",icon:"mdi-dots-vertical",variant:"tonal",onClick:a},null,8,["onClick"])]),_:1},8,["spirit"])]),_:1}),h("div",st,[t(Te,{height:"250",src:e.spirit.image,contain:""},null,8,["src"])]),t(Ie,null,{default:o(()=>[t(Be,null,{default:o(()=>[x(f(e.spirit.name),1)]),_:1})]),_:1}),t(Ne,null,{default:o(()=>{var a,i;return[t(Ee,{align:"center",class:"mx-0"},{default:o(()=>[t(We,{"model-value":e.spirit.rating,color:"amber",density:"compact",size:"small",class:"mb-4","half-increments":"",readonly:""},null,8,["model-value"])]),_:1}),h("div",rt,[h("p",null,"Company: "+f((a=e.spirit.company)==null?void 0:a.name),1)]),h("div",dt,[h("p",null,"Brand: "+f((i=e.spirit.brand)==null?void 0:i.name),1)]),(k(!0),le(E,null,ze(e.spirit.distilleries,U=>(k(),b(y,{key:U.id,distillery:U},null,8,["distillery"]))),128)),h("div",ut,[e.spirit.spirit_type?(k(),b(j,{key:0,class:"mr-2 mt-2",color:e.spirit.spirit_type.colour,size:"small",label:""},{default:o(()=>[t(z,{icon:e.spirit.spirit_type.icon,start:""},null,8,["icon"]),x(" "+f(e.spirit.spirit_type.name),1)]),_:1},8,["color"])):L("",!0),e.spirit.spirit_style?(k(),b(j,{key:1,class:"mr-2 mt-2",color:e.spirit.spirit_style.colour,size:"small",label:""},{default:o(()=>[t(z,{icon:e.spirit.spirit_style.icon,start:""},null,8,["icon"]),x(" "+f(e.spirit.spirit_style.name),1)]),_:1},8,["color"])):L("",!0),e.spirit.ppm?(k(),b(j,{key:2,color:"#8c4f00",size:"small",class:"mt-2",label:""},{default:o(()=>[t(z,{icon:"mdi mdi-smoke",start:""}),x(" "+f(e.spirit.ppm),1)]),_:1})):L("",!0)]),h("div",ct,[h("div",null,f(e.spirit.description||"No description."),1)])]}),_:1}),t(Me,null,{default:o(()=>[t(G,{href:e.spiritLink,color:"deep-purple-lighten-2",text:"More",block:"",border:""},null,8,["href"])]),_:1})]),_:1})}const Vt=K(ot,[["render",mt]]);export{Vt as S,tt as a};
