import{d as F,u as U,r as h,e as v,_ as w,l as u,o as l,c as i,w as o,n as R,a as n,i as S,j as V,t as k,b as T,g as _,p as j,q as N,s as L,v as A,x as E,F as b,k as B,y as O,z as I,f as P,h as C,V as g}from"./index-DnvRLiit.js";import{M as z}from"./Map-68B2R_UU.js";import{R as D,S as H,V as G,a as M}from"./VForm-TVvqgWn1.js";import{V as c}from"./VCol-mdlYBquf.js";import{V as $}from"./VContainer-BniP9kR8.js";import{V as J}from"./VAlert-CfdN9_tS.js";import{V as K}from"./VSkeletonLoader-Bh_PGYJS.js";const Q=F({name:"CompanyForm",props:{company:{type:Object,required:!1,default:()=>({name:"",image:""})}},components:{RecordForm:D,SelectFromRequest:H},setup(e){U();const t=h([]),s=v(()=>!!e.company.id),d=v(()=>s.value?`https://api.fordsdevelopment.co.uk/drinks/companies/${e.company.id}`:"https://api.fordsdevelopment.co.uk/drinks/companies"),m=v(()=>s.value?"PUT":"POST");return{isEditMode:s,endpoint:d,method:m,handleSave:async r=>{console.log(`${s.value?"Updated":"Created"} record:`,r),window.location.reload()},value:t}}});function W(e,t,s,d,m,f){const r=u("SelectFromRequest"),p=u("RecordForm");return l(),i(p,{record:e.company,endpoint:e.endpoint,method:e.method,onSave:e.handleSave},{trigger:o(({openDialog:a})=>[R(e.$slots,"trigger",{openDialog:a},()=>[n(S,{color:"primary"},{default:o(()=>[V(k(e.isEditMode?"Edit Spirit":"Add Company"),1)]),_:1})])]),title:o(()=>[T("span",null,k(e.isEditMode?"Edit Company":"Add New Company"),1)]),form:o(({record:a})=>[n(G,null,{default:o(()=>[n(M,{modelValue:a.name,"onUpdate:modelValue":y=>a.name=y,label:"Name",required:""},null,8,["modelValue","onUpdate:modelValue"]),n(M,{modelValue:a.logo,"onUpdate:modelValue":y=>a.logo=y,label:"Image"},null,8,["modelValue","onUpdate:modelValue"]),n(r,{path:"brands",key:"name",name:"brand_ids",multiple:!0,modelValue:a.brand_ids,"onUpdate:modelValue":y=>a.brand_ids=y},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:3},8,["record","endpoint","method","onSave"])}const q=w(Q,[["render",W]]),X=F({name:"BrandLink",props:{brand:{type:Object,required:!0}}});function Y(e,t,s,d,m,f){const r=u("router-link");return l(),_("div",null,[n(r,{to:{name:"brands",params:{id:e.brand.id}}},{default:o(()=>[V(k(e.brand.name),1)]),_:1},8,["to"])])}const Z=w(X,[["render",Y]]),x=F({name:"Company",props:{company:{type:Object,required:!0}},components:{CompanyForm:q,BrandLink:Z},setup(e){return{companyLink:v(()=>`/Drinks/#/companies/${e.company.id}`)}}});function ee(e,t,s,d,m,f){const r=u("CompanyForm"),p=u("BrandLink");return l(),i(I,null,{loader:o(({isActive:a})=>[n(j,{active:a,color:"deep-purple",height:"4",indeterminate:""},null,8,["active"])]),default:o(()=>[n(c,{cols:"12"},{default:o(()=>[n(r,{company:e.company},{trigger:o(({openDialog:a})=>[n(S,{density:"comfortable",icon:"mdi-dots-vertical",variant:"tonal",onClick:a},null,8,["onClick"])]),_:1},8,["company"])]),_:1}),n(N,{height:"250",src:e.company.logo,cover:""},null,8,["src"]),n(L,null,{default:o(()=>[n(A,null,{default:o(()=>[V(k(e.company.name),1)]),_:1})]),_:1}),n(L,null,{default:o(()=>[n(E,null,{default:o(()=>t[0]||(t[0]=[V("Brands:")])),_:1}),(l(!0),_(b,null,B(e.company.brands,a=>(l(),i(p,{key:a.id,brand:a},null,8,["brand"]))),128))]),_:1}),n(O,null,{default:o(()=>[n(S,{href:e.companyLink,color:"deep-purple-lighten-2",text:"More",block:"",border:""},null,8,["href"])]),_:1})]),_:1})}const oe=w(x,[["render",ee]]),ne=F({name:"HomeView",components:{Map:z,Company:oe,CompanyForm:q},setup(){const e=U(),t=h([]),s=h(null),d=h(!0),m=async()=>{const r=await fetch("https://api.fordsdevelopment.co.uk/drinks/companies",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.accessToken}`}});if(r.ok)t.value=await r.json(),d.value=!1;else{const p=await r.json();s.value=p.error,d.value=!1}};return P(()=>{m()}),{fetchCompanies:m,companies:t,errorMessage:s,loading:d}}});function ae(e,t,s,d,m,f){const r=u("CompanyForm"),p=u("Company");return l(),_(b,null,[n($,null,{default:o(()=>[n(g,null,{default:o(()=>[n(c,{cols:"6"},{default:o(()=>t[0]||(t[0]=[T("h1",null,"Companies",-1)])),_:1}),n(c,{cols:"6",class:"text-right"},{default:o(()=>[n(r,{company:e.company},{trigger:o(({openDialog:a})=>[n(S,{density:"comfortable",variant:"tonal",text:"New Company",onClick:a},null,8,["onClick"])]),_:1},8,["company"])]),_:1})]),_:1})]),_:1}),e.loading?C("",!0):(l(),i($,{key:0},{default:o(()=>[n(g,null,{default:o(()=>[n(c,{cols:"12"},{default:o(()=>[e.errorMessage?(l(),i(J,{key:0,type:"error",dismissible:"",border:"left",elevation:"2"},{default:o(()=>[V(k(e.errorMessage),1)]),_:1})):C("",!0)]),_:1})]),_:1})]),_:1})),e.loading?C("",!0):(l(),i($,{key:1},{default:o(()=>[n(g,null,{default:o(()=>[(l(!0),_(b,null,B(e.companies,a=>(l(),i(c,{cols:"12",sm:"6",md:"4",lg:"3",key:a.id},{default:o(()=>[n(p,{company:a},null,8,["company"])]),_:2},1024))),128))]),_:1})]),_:1})),e.loading?(l(),i($,{key:2},{default:o(()=>[n(g,null,{default:o(()=>[(l(),_(b,null,B(16,a=>n(c,{cols:"12",sm:"6",md:"4",lg:"3"},{default:o(()=>[n(K,{class:"border",type:"image, article"})]),_:1})),64))]),_:1})]),_:1})):C("",!0)],64)}const pe=w(ne,[["render",ae]]);export{pe as default};
