import{d as y,u as T,r as V,e as f,_ as C,l as _,o as u,c as b,w as n,n as N,a as e,i as k,j as B,t as h,b as R,p as j,s as S,v as q,a5 as E,x as L,y as M,f as O,g,h as P,F as v,V as $,k as F}from"./index-CXTJE7Gf.js";import{R as D,S as I,V as x,a as w}from"./VForm-E0dd8P_u.js";import{V as p}from"./VCol-CyUiFGvx.js";import{V as U}from"./VContainer-Bjfcy4Zc.js";import{V as z}from"./VSkeletonLoader-B92uIFKc.js";const G=y({name:"BrandForm",props:{brand:{type:Object,required:!1,default:()=>({name:"",image:""})}},components:{RecordForm:D,SelectFromRequest:I},setup(a){T();const r=V([]),l=f(()=>!!a.brand.id),s=f(()=>l.value?`https://api.fordsdevelopment.co.uk/drinks/brands/${a.brand.id}`:"https://api.fordsdevelopment.co.uk/drinks/brands"),c=f(()=>l.value?"PUT":"POST");return{isEditMode:l,endpoint:s,method:c,handleSave:async d=>{console.log(`${l.value?"Updated":"Created"} record:`,d),window.location.reload()},value:r}}});function H(a,r,l,s,c,i){const d=_("SelectFromRequest"),t=_("RecordForm");return u(),b(t,{record:a.brand,endpoint:a.endpoint,method:a.method,onSave:a.handleSave},{trigger:n(({openDialog:o})=>[N(a.$slots,"trigger",{openDialog:o},()=>[e(k,{color:"primary"},{default:n(()=>[B(h(a.isEditMode?"Edit Spirit":"Add Brand"),1)]),_:1})])]),title:n(()=>[R("span",null,h(a.isEditMode?"Edit Brand":"Add New Brand"),1)]),form:n(({record:o})=>[e(x,null,{default:n(()=>[e(w,{modelValue:o.name,"onUpdate:modelValue":m=>o.name=m,label:"Name",required:""},null,8,["modelValue","onUpdate:modelValue"]),e(w,{modelValue:o.logo,"onUpdate:modelValue":m=>o.logo=m,label:"Image"},null,8,["modelValue","onUpdate:modelValue"]),e(d,{path:"companies",key:"name",name:"company_id",modelValue:o.company_id,"onUpdate:modelValue":m=>o.company_id=m},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:3},8,["record","endpoint","method","onSave"])}const A=C(G,[["render",H]]),J=y({name:"Brand",props:{brand:{type:Object,required:!0}},components:{BrandForm:A},setup(a){return{brandLink:f(()=>`/Drinks/#/brands/${a.brand.id}`)}}});function K(a,r,l,s,c,i){const d=_("BrandForm");return u(),b(M,null,{loader:n(({isActive:t})=>[e(j,{active:t,color:"deep-purple",height:"4",indeterminate:""},null,8,["active"])]),default:n(()=>[e(p,{cols:"12"},{default:n(()=>[e(d,{brand:a.brand},{trigger:n(({openDialog:t})=>[e(k,{density:"comfortable",icon:"mdi-dots-vertical",variant:"tonal",onClick:t},null,8,["onClick"])]),_:1},8,["brand"])]),_:1}),e(S,null,{default:n(()=>[e(q,null,{default:n(()=>[B(h(a.brand.name),1)]),_:1})]),_:1}),e(S,null,{default:n(()=>[e(E,null,{default:n(()=>{var t;return[B("Company: "+h((t=a.brand.company)==null?void 0:t.name),1)]}),_:1})]),_:1}),e(L,null,{default:n(()=>[e(k,{href:a.brandLink,color:"deep-purple-lighten-2",text:"More",block:"",border:""},null,8,["href"])]),_:1})]),_:1})}const Q=C(J,[["render",K]]),W=y({name:"BrandsView",components:{BrandForm:A,Brand:Q},setup(){const a=V([]),r=V(!0),l=f(()=>"https://api.fordsdevelopment.co.uk/drinks/brands"),s=V(null),c=async()=>{const i=T(),t=await fetch("https://api.fordsdevelopment.co.uk/drinks/brands",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${i.accessToken}`}});if(t.ok)r.value=!1,a.value=await t.json();else{r.value=!1;const o=await t.json();s.value=o.error,o.error==="Access token has expired or is invalid."&&(console.log("Access token has expired or is invalid."),i.$reset(),i.clearState())}};return O(()=>{c()}),{brands:a,loading:r,endpoint:l,errorMessage:s}}});function X(a,r,l,s,c,i){const d=_("BrandForm"),t=_("Brand");return u(),g(v,null,[e(U,null,{default:n(()=>[e($,null,{default:n(()=>[e(p,{cols:"6"},{default:n(()=>r[0]||(r[0]=[R("h1",null,"Brands",-1)])),_:1}),e(p,{cols:"6",class:"text-right"},{default:n(()=>[e(d,null,{trigger:n(({openDialog:o})=>[e(k,{density:"comfortable",variant:"tonal",text:"New Brand",onClick:o},null,8,["onClick"])]),_:1})]),_:1})]),_:1}),e($,null,{default:n(()=>[(u(!0),g(v,null,F(a.brands,o=>(u(),b(p,{cols:"12",sm:"6",md:"4",lg:"3",key:o.id},{default:n(()=>[e(t,{brand:o},null,8,["brand"])]),_:2},1024))),128))]),_:1})]),_:1}),a.loading?(u(),b(U,{key:0},{default:n(()=>[e($,null,{default:n(()=>[(u(),g(v,null,F(16,o=>e(p,{cols:"12",sm:"6",md:"4",lg:"3"},{default:n(()=>[e(z,{class:"border",type:"image, article"})]),_:1})),64))]),_:1})]),_:1})):P("",!0)],64)}const oe=C(W,[["render",X]]);export{oe as default};
